<div class="cajas-container">
  <!-- Resumen Financiero -->
  <div class="financial-summary">
    <div class="summary-card">
      <div class="summary-header">
        <h3>Resumen Financiero</h3>
        <div class="summary-refresh">
          <button class="btn-refresh" (click)="refreshFinancial()">
            <i class="fas fa-sync"></i>
            Actualizar
          </button>
        </div>
      </div>
      <div class="summary-grid">
        <div class="summary-item">
          <div class="summary-icon">
            <i class="fas fa-chart-line"></i>
          </div>
          <div class="summary-content">
            <h4>Total Ventas</h4>
            <p class="amount">${{ totalVentas }}</p>
            <p class="trend positive">+12.5% desde ayer</p>
          </div>
        </div>
        <div class="summary-item">
          <div class="summary-icon">
            <i class="fas fa-money-bill-wave"></i>
          </div>
          <div class="summary-content">
            <h4>Efectivo</h4>
            <p class="amount">${{ efectivo }}</p>
            <p class="trend neutral">0% desde ayer</p>
          </div>
        </div>
        <div class="summary-item">
          <div class="summary-icon">
            <i class="fas fa-credit-card"></i>
          </div>
          <div class="summary-content">
            <h4>Tarjeta</h4>
            <p class="amount">${{ tarjeta }}</p>
            <p class="trend positive">+8.2% desde ayer</p>
          </div>
        </div>
        <div class="summary-item">
          <div class="summary-icon">
            <i class="fas fa-exchange-alt"></i>
          </div>
          <div class="summary-content">
            <h4>Cambio</h4>
            <p class="amount">${{ cambio }}</p>
            <p class="trend negative">-5.4% desde ayer</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Gestión de Cajas -->
  <div class="cajas-management">
    <div class="header">
      <div class="header-content">
        <h2><i class="fas fa-cash-register"></i> Gestión de Cajas</h2>
        <div class="actions">
          <button class="btn-primary" (click)="openModal('nueva')">
            <i class="fas fa-plus"></i> Nueva Caja
          </button>
        </div>
      </div>
    </div>

    <!-- Tabla de Cajas -->
    <div class="table-container">
      <div class="table-header">
        <div class="table-filter">
          <input type="text" #searchInput placeholder="Buscar caja..." (input)="searchCajas(searchInput.value)">
          <i class="fas fa-search"></i>
        </div>
      </div>
      <table>
        <thead>
          <tr>
            <th>Número</th>
            <th>Descripción</th>
            <th>Estado</th>
            <th>Efectivo Inicial</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          @for (caja of filteredCajas; track caja.id_caja) {
            <tr>
              <td>{{ caja.numero_caja }}</td>
              <td>{{ caja.descripcion }}</td>
              <td>
                <span [class]="'status-' + caja.estado.toLowerCase()">
                  <i class="fas fa-circle"></i>
                  {{ caja.estado }}
                </span>
              </td>
              <td>${{ caja.efectivo_inicial }}</td>
              <td>
                <button class="btn-edit" (click)="openModal('editar', caja)">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="btn-delete" (click)="deleteCaja(caja.id_caja)">
                  <i class="fas fa-trash"></i>
                </button>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>

    <!-- Modal de Caja -->
    <div class="modal" [class]="showModal ? 'showModal' : ''">
      <div class="modal-content">
        <div class="modal-header">
          <h3>{{ modalType === 'nueva' ? 'Nueva Caja' : 'Editar Caja' }}</h3>
          <button class="btn-close" (click)="closeModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <form [formGroup]="cajaForm" (ngSubmit)="onSubmit()">
          <div class="form-group">
            <div class="form-label">
              <i class="fas fa-hashtag"></i>
              <label>Número de Caja</label>
            </div>
            <input type="number" formControlName="numero_caja">
          </div>
          <div class="form-group">
            <div class="form-label">
              <i class="fas fa-tag"></i>
              <label>Descripción</label>
            </div>
            <input type="text" formControlName="descripcion">
          </div>
          <div class="form-group">
            <div class="form-label">
              <i class="fas fa-money-bill"></i>
              <label>Efectivo Inicial</label>
            </div>
            <input type="number" formControlName="efectivo_inicial">
          </div>
          <div class="form-group">
            <div class="form-label">
              <i class="fas fa-toggle-on"></i>
              <label>Estado</label>
            </div>
            <select formControlName="estado">
              <option value="Abierta">Abierta</option>
              <option value="Cerrada">Cerrada</option>
            </select>
          </div>
          <div class="modal-actions">
            <button type="submit" class="btn-primary">
              <i class="fas fa-save"></i>
              Guardar
            </button>
            <button class="btn-secondary" (click)="closeModal()">
              <i class="fas fa-times"></i>
              Cancelar
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
